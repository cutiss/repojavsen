<!-- public/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Canvas UI</title>
  <style>
    canvas {
      border: 1px solid #ccc;
      display: block;
      margin: 0 auto;
    }
  </style>
</head>
<body>
<canvas id="canvas" width="1344" height="634"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

const inputBox = { x: 535, y: 409, width: 300, height: 40 };
const buttonBox = { x: 535, y: 470, width: 300, height: 50 };

let userInput = '';
let isTyping = false;

const bgImage = new Image();
bgImage.src = 'background.png';
bgImage.onload = () => drawUI();

function drawUI() {
  ctx.drawImage(bgImage, 0, 0, canvas.width, canvas.height);
  ctx.fillStyle = '#fff';
  ctx.fillRect(inputBox.x, inputBox.y, inputBox.width, inputBox.height);
  ctx.strokeStyle = '#ccc';
  ctx.strokeRect(inputBox.x, inputBox.y, inputBox.width, inputBox.height);
  ctx.fillStyle = '#000';
  ctx.font = '16px Arial';
  ctx.fillText(userInput, inputBox.x + 10, inputBox.y + 25);

  ctx.fillStyle = '#0078d4';
  ctx.fillRect(buttonBox.x, buttonBox.y, buttonBox.width, buttonBox.height);
  ctx.fillStyle = '#fff';
  ctx.font = '20px Arial';
  ctx.fillText('Next', buttonBox.x + 125, buttonBox.y + 32);
}

canvas.addEventListener('mousedown', (e) => {
  const rect = canvas.getBoundingClientRect();
  const mouseX = e.clientX - rect.left;
  const mouseY = e.clientY - rect.top;

  if (mouseX >= inputBox.x && mouseX <= inputBox.x + inputBox.width &&
      mouseY >= inputBox.y && mouseY <= inputBox.y + inputBox.height) {
    isTyping = true;
  } else {
    isTyping = false;
  }

  if (mouseX >= buttonBox.x && mouseX <= buttonBox.x + buttonBox.width &&
      mouseY >= buttonBox.y && mouseY <= buttonBox.y + buttonBox.height) {
    sendEmail(userInput);
  }
});

document.addEventListener('keydown', (e) => {
  if (isTyping) {
    if (e.key === 'Backspace') {
      userInput = userInput.slice(0, -1);
    } else if (e.key.length === 1) {
      userInput += e.key;
    }
    drawUI();
  }
});

function sendEmail(email) {
  fetch('/send-email', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ email })
  })
  .then(res => res.json())
  .then(data => alert(data.message))
  .catch(err => alert("Error sending email."));
}
</script>
</body>
</html>
